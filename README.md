# 台灣股票成交量分析系統

## 專案簡介
這是一個用於分析台灣證券交易所股票成交量的網頁應用程式，提供即時股票資料查詢、篩選、匯出功能以及產業代號查詢功能。

## 功能特點

### 即時資料
- 從台灣證券交易所獲取即時股票資料
- 支援多種資料來源（MI_INDEX, STOCK_DAY_ALL）
- 自動切換備用資料來源
- 離線時可使用示範資料
- 全球主要股市指數即時行情（使用 Yahoo Finance API）
- 完整的產業代號與名稱對照表

### 資料篩選
- 多種篩選條件：
  - 成交量（張數）
  - 成交價
  - 漲跌幅（%）
  - 成交筆數
  - 股票名稱/代碼
- 支援數值比較（大於、小於、等於）
- 支援文字模糊搜尋

### 資料視覺化
- 清晰的表格展示
- 漲跌以不同顏色標示（紅漲綠跌）
- 全球指數無縫循環跑馬燈顯示
- 響應式設計，支援各種裝置

### 資料匯出
- 將當前顯示的資料匯出為Excel格式
- 保留所有篩選條件

## 系統架構

### 前端 (Frontend)
- **index.html** - 主頁面結構
- **industries.html** - 產業代號查詢頁面
- **app.js** - 主要業務邏輯
  - 股票資料獲取與處理
  - 全球指數資料處理與顯示
  - 跑馬燈動畫控制
  - 資料篩選與排序
- **styles.css** - 樣式設計
  - 響應式佈局
  - 跑馬燈動畫效果
  - 自適應顏色主題
  - 表格與表單樣式

### 後端 (Backend)
- **server.js** - Node.js + Express 伺服器
  - 提供RESTful API
  - 處理CORS
  - 代理請求台灣證券交易所API
  - 整合 Yahoo Finance API 獲取全球指數資料
  - 產業代號資料獲取與快取
  - 資料快取機制（5分鐘）
  - 錯誤處理與日誌記錄
  - 備用資料機制（當API不可用時）

## 安裝與執行

### 必要條件
- Node.js (v14以上)
- npm 或 yarn

### 後端設定
1. 進入專案目錄
   ```bash
   cd server
   ```
2. 安裝相依套件
   ```bash
   npm install express axios cors
   ```
3. 啟動伺服器
   ```bash
   node server.js
   ```

### 前端執行
1. 使用瀏覽器開啟 `index.html` 或使用 Live Server 等工具

## 使用說明

### 股票查詢功能
1. 點擊「取得股票資料」按鈕開始獲取資料
2. 使用篩選功能找到符合條件的股票
3. 點擊「匯出Excel」將資料匯出

### 產業代號查詢
1. 點擊「查詢產業代號」按鈕開啟查詢頁面
2. 在搜尋框中輸入產業代號或名稱進行搜尋
3. 表格會即時顯示符合條件的產業代號

### 全球指數資訊
- 頂部跑馬燈顯示全球主要股市即時行情
  - 紅色表示上漲
  - 綠色表示下跌
  - 懸停可暫停滾動

## 技術規格
- **前端技術**：
  - HTML5, CSS3, JavaScript (ES6+)
  - 原生DOM操作
  - CSS3 動畫效果
  - 響應式設計
  - 無縫滾動實現
  - 事件委託優化

- **後端技術**：
  - Node.js
  - Express.js
  - Axios (HTTP客戶端)
  - yahoo-finance2 (全球指數資料獲取)
  - CORS 處理
  - 快取機制

## 授權
MIT License

## 注意事項
- 本系統資料來源為台灣證券交易所
- 資料更新頻率受限於證交所API
- 投資決策請參考專業建議

## 未來改進
- 增加技術分析圖表
- 加入更多技術指標
- 實現即時更新功能
- 增加使用者自訂警示
- 優化行動裝置體驗
- 增加更多國際市場指數
- 自訂跑馬燈滾動速度
- 增加指數點擊查看詳細資訊功能
- 增加產業別股票列表查詢
- 加入產業別走勢分析
- 提供產業代號API文檔

## 貢獻
歡迎提交 Issue 或 Pull Request
